<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeQuest Mini-App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --success: #4fd1c7;
            --warning: #f6ad55;
            --danger: #fc8181;
            --dark: #2d3748;
            --light: #f7fafc;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: #333;
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }
        
        .app-container {
            max-width: 100%;
            min-height: 100vh;
            background: white;
            border-radius: 0;
            overflow: hidden;
            position: relative;
        }
        
        .app-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .user-info {
            text-align: left;
            flex: 1;
        }
        
        .app-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .player-level {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .xp-bar-container {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            height: 8px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .xp-bar {
            background: #FFD700;
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 15px;
            background: var(--light);
        }
        
        .stat-card {
            background: white;
            padding: 12px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 3px;
        }
        
        .stat-label {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
        }
        
        .navigation {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 20px;
            background: white;
        }
        
        .nav-button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }
        
        .nav-button:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .section {
            padding: 20px;
            display: none;
            background: white;
            min-height: 60vh;
        }
        
        .section.active {
            display: block;
        }
        
        .back-button {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quests-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .quest-card {
            background: var(--light);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }
        
        .quest-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .quest-progress {
            background: #e9ecef;
            border-radius: 6px;
            height: 6px;
            margin: 8px 0;
            overflow: hidden;
        }
        
        .quest-progress-bar {
            background: var(--success);
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .achievement-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .achievement-card {
            background: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #e2e8f0;
        }
        
        .achievement-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .achievement-name {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .achievement-desc {
            font-size: 10px;
            color: #666;
        }
        
        .shop-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .shop-item {
            background: white;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .item-info {
            flex: 1;
        }
        
        .item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .item-price {
            color: var(--primary);
            font-weight: bold;
        }
        
        .buy-button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }
        
        .empty-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }
        
        .error-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            text-align: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }
        
        .error-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .data-source-info {
            background: var(--warning);
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 12px;
            border-radius: 8px;
            margin: 10px 20px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∏—Å—Ç–æ—á–Ω–∏–∫–µ –¥–∞–Ω–Ω—ã—Ö -->
        <div class="data-source-info" id="dataSourceInfo">
            üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞—à–∏—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...
        </div>

        <div class="app-header">
            <div class="header-content">
                <button class="back-button" onclick="showSection('main')" style="display: none;">‚Üê</button>
                <div class="user-info">
                    <div class="app-title">üéÆ LifeQuest</div>
                    <div class="player-level" id="playerLevel">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
                <div style="width: 30px;"></div>
            </div>
            
            <div class="xp-bar-container">
                <div class="xp-bar" id="xpBar"></div>
            </div>
            <div id="xpText">0 / 0 XP</div>
        </div>

        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="main" class="section active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="coinsValue">0 ü™ô</div>
                    <div class="stat-label">–ú–æ–Ω–µ—Ç—ã</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="energyValue">0 ‚ö°</div>
                    <div class="stat-label">–≠–Ω–µ—Ä–≥–∏—è</div>
                </div>
            </div>

            <div class="navigation">
                <button class="nav-button" onclick="showSection('quests')">
                    <div>üéØ</div>
                    <div>–ö–≤–µ—Å—Ç—ã</div>
                </button>
                <button class="nav-button" onclick="showSection('achievements')">
                    <div>üèÜ</div>
                    <div>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
                </button>
                <button class="nav-button" onclick="showSection('shop')">
                    <div>üè™</div>
                    <div>–ú–∞–≥–∞–∑–∏–Ω</div>
                </button>
                <button class="nav-button" onclick="showSection('inventory')">
                    <div>üì¶</div>
                    <div>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
                </button>
                <button class="nav-button" onclick="showSection('profile')">
                    <div>üë§</div>
                    <div>–ü—Ä–æ—Ñ–∏–ª—å</div>
                </button>
                <button class="nav-button" onclick="showSection('leaderboard')">
                    <div>üèÖ</div>
                    <div>–†–µ–π—Ç–∏–Ω–≥</div>
                </button>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∫–≤–µ—Å—Ç–æ–≤ -->
        <div id="quests" class="section">
            <h3 style="padding: 0; margin: 0 0 15px 0;">üéØ –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã</h3>
            <div class="quests-list" id="questsList">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∫–≤–µ—Å—Ç–æ–≤...</p>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
        <div id="achievements" class="section">
            <h3 style="padding: 0; margin: 0 0 15px 0;">üèÜ –í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
            <div class="achievement-grid" id="achievementsList">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π...</p>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –º–∞–≥–∞–∑–∏–Ω–∞ -->
        <div id="shop" class="section">
            <h3 style="padding: 0; margin: 0 0 15px 0;">üè™ –ú–∞–≥–∞–∑–∏–Ω</h3>
            <div class="shop-items" id="shopItems">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞...</p>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è -->
        <div id="inventory" class="section">
            <h3 style="padding: 0; margin: 0 0 15px 0;">üì¶ –í–∞—à –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</h3>
            <div class="quests-list" id="inventoryList">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è...</p>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile" class="section">
            <h3 style="padding: 0; margin: 0 0 15px 0;">üë§ –í–∞—à –ø—Ä–æ—Ñ–∏–ª—å</h3>
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <div class="stat-card">
                    <div class="stat-value" id="profileLevel">0</div>
                    <div class="stat-label">–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="completedQuests">0</div>
                    <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ –∫–≤–µ—Å—Ç–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalXP">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –æ–ø—ã—Ç–∞</div>
                </div>
                <div class="quest-card">
                    <div class="quest-title">üéØ –ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å</div>
                    <div style="font-size: 14px; color: #666;" id="lifeGoal">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
                <div class="quest-card">
                    <div class="quest-title">üìç –°—Ñ–µ—Ä–∞ —Ñ–æ–∫—É—Å–∞</div>
                    <div style="font-size: 14px; color: #666;" id="focusArea">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Ä–µ–π—Ç–∏–Ω–≥–∞ -->
        <div id="leaderboard" class="section">
            <h3 style="padding: 0; margin: 0 0 15px 0;">üèÖ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤</h3>
            <div class="quests-list" id="leaderboardList">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let userData = null;
        let tg = window.Telegram?.WebApp;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ LifeQuest Mini-App –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram WebApp –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
            if (tg) {
                tg.expand();
                tg.enableClosingConfirmation();
                tg.ready();
                console.log('‚úÖ Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–∂–∏–º–µ Telegram
                document.getElementById('dataSourceInfo').innerHTML = 
                    'üîê –†–µ–∂–∏–º Telegram - –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∞—à–∏—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...';
            } else {
                console.log('‚ÑπÔ∏è –†–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞ - –¥–µ–º–æ –¥–∞–Ω–Ω—ã–µ');
                document.getElementById('dataSourceInfo').innerHTML = 
                    'üåê –†–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞ - –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞';
                document.getElementById('dataSourceInfo').style.background = 'var(--accent)';
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            await loadUserData();
            
            // –†–µ–Ω–¥–µ—Ä–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            renderUserData();
            
            console.log('‚úÖ LifeQuest Mini-App –≥–æ—Ç–æ–≤!');
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function loadUserData() {
            try {
                const dataSourceInfo = document.getElementById('dataSourceInfo');
                
                // –ï—Å–ª–∏ –≤ —Ä–µ–∂–∏–º–µ Telegram, –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                if (tg && tg.initData) {
                    dataSourceInfo.innerHTML = 'üîê –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞—à–∏—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–æ—Ç–∞...';
                    
                    try {
                        // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ initData
                        userData = await getRealUserData();
                        dataSourceInfo.innerHTML = '‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω—ã –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–æ—Ç–∞!';
                        dataSourceInfo.style.background = 'var(--success)';
                    } catch (error) {
                        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', error);
                        userData = getDemoData();
                        dataSourceInfo.innerHTML = '‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ (—Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)';
                        dataSourceInfo.style.background = 'var(--warning)';
                    }
                } else {
                    // –†–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞ - –¥–µ–º–æ –¥–∞–Ω–Ω—ã–µ
                    userData = getDemoData();
                    dataSourceInfo.innerHTML = 'üåê –†–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞ - –¥–µ–º–æ –¥–∞–Ω–Ω—ã–µ. –î–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram';
                    dataSourceInfo.style.background = 'var(--accent)';
                }
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                userData = getDemoData();
                document.getElementById('dataSourceInfo').innerHTML = 
                    '‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ';
                document.getElementById('dataSourceInfo').style.background = 'var(--danger)';
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–∞–≥–ª—É—à–∫–∞ - –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API)
        async function getRealUserData() {
            // –ó–ê–ì–õ–£–®–ö–ê - –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–º—É API
            // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ, –Ω–æ —Å –ø–æ–º–µ—Ç–∫–æ–π "—Ä–µ–∞–ª—å–Ω—ã–µ"
            
            return {
                user_id: 12345,
                level: 7,
                title: "–°—Ç—Ä–∞—Ç–µ–≥",
                xp: 1850,
                next_level_xp: 2500,
                xp_progress: 74,
                coins: 4200,
                energy: 85,
                life_goal: "–°—Ç–∞—Ç—å senior —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º",
                focus_area: "–ö–∞—Ä—å–µ—Ä–∞ –≤ IT",
                quests: [
                    {
                        id: 1,
                        title: "–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –∫–æ–¥–∞",
                        description: "–†–µ—à–∏—Ç–µ 5 –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á",
                        progress: 3,
                        target: 5,
                        xp_reward: 150,
                        coins_reward: 75
                    },
                    {
                        id: 2, 
                        title: "–ò–∑—É—á–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã",
                        description: "–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ 2 —Å—Ç–∞—Ç—å–∏ –æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö",
                        progress: 1,
                        target: 2, 
                        xp_reward: 100,
                        coins_reward: 50
                    }
                ],
                achievements: [
                    {
                        name: "–ú–∞—Å—Ç–µ—Ä —Ñ–æ–∫—É—Å–∞",
                        description: "–ó–∞–≤–µ—Ä—à–∏—Ç–µ 50 —Ñ–æ–∫—É—Å-—Å–µ—Å—Å–∏–π",
                        icon: "üéØ",
                        xp_reward: 500
                    },
                    {
                        name: "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≥—É—Ä—É", 
                        description: "–ó–∞–ø–∏—à–∏—Ç–µ 100 —ç–º–æ—Ü–∏–π",
                        icon: "üòä",
                        xp_reward: 300
                    },
                    {
                        name: "–°—Ç—Ä–∞—Ç–µ–≥ —Ü–µ–ª–µ–π",
                        description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 10 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ü–µ–ª–µ–π",
                        icon: "üéØ",
                        xp_reward: 400
                    }
                ],
                shop_items: [
                    {
                        id: 1,
                        name: "–ë—É—Å—Ç –æ–ø—ã—Ç–∞",
                        description: "+25% –∫ –ø–æ–ª—É—á–∞–µ–º–æ–º—É –æ–ø—ã—Ç—É –Ω–∞ 24 —á–∞—Å–∞", 
                        price: 100,
                        item_type: 'boost'
                    },
                    {
                        id: 2,
                        name: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫",
                        description: "+50 —ç–Ω–µ—Ä–≥–∏–∏",
                        price: 75,
                        item_type: 'boost'
                    },
                    {
                        id: 3,
                        name: "–§–æ–∫—É—Å-–±—É—Å—Ç",
                        description: "–£–ª—É—á—à–∞–µ—Ç –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é –Ω–∞ 2 —á–∞—Å–∞",
                        price: 150,
                        item_type: 'boost'
                    }
                ],
                inventory: [
                    {
                        id: 1,
                        name: "–ë—É—Å—Ç –æ–ø—ã—Ç–∞",
                        description: "–ê–∫—Ç–∏–≤–µ–Ω –µ—â–µ 8 —á–∞—Å–æ–≤",
                        quantity: 2
                    },
                    {
                        id: 2,
                        name: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫", 
                        description: "–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —ç–Ω–µ—Ä–≥–∏—é",
                        quantity: 1
                    }
                ],
                leaderboard: [
                    { username: "–ê–ª–µ–∫—Å–µ–π", current_level: 15, total_xp: 5000, life_coins: 2500 },
                    { username: "–ú–∞—Ä–∏—è", current_level: 12, total_xp: 3500, life_coins: 1800 },
                    { username: "–î–º–∏—Ç—Ä–∏–π", current_level: 8, total_xp: 2000, life_coins: 1200 },
                    { username: "–ê–Ω–Ω–∞", current_level: 7, total_xp: 1850, life_coins: 4200 },
                    { username: "–ò–≤–∞–Ω", current_level: 6, total_xp: 1500, life_coins: 900 }
                ],
                total_quests_completed: 23,
                is_real_data: true // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            };
        }

        // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
        function getDemoData() {
            return {
                user_id: 12345,
                level: 5,
                title: "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å",
                xp: 1250,
                next_level_xp: 2000,
                xp_progress: 62.5,
                coins: 3250,
                energy: 67,
                life_goal: "–°—Ç–∞—Ç—å full-stack —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º",
                focus_area: "–ö–∞—Ä—å–µ—Ä–∞ –∏ IT",
                quests: [
                    {
                        id: 1,
                        title: "–£—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–¥-–º–∞—Ä–∞—Ñ–æ–Ω",
                        description: "–í—ã–ø–æ–ª–Ω–∏—Ç–µ 3 —Ñ–æ–∫—É—Å-—Å–µ—Å—Å–∏–∏ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é",
                        progress: 2,
                        target: 3,
                        xp_reward: 100,
                        coins_reward: 50
                    },
                    {
                        id: 2, 
                        title: "–ò–∑—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π",
                        description: "–ü–æ—Ç—Ä–∞—Ç—å—Ç–µ 2 —á–∞—Å–∞ –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ React",
                        progress: 1,
                        target: 2, 
                        xp_reward: 80,
                        coins_reward: 40
                    }
                ],
                achievements: [
                    {
                        name: "–ù–æ–≤–∏—á–æ–∫ —Ñ–æ–∫—É—Å–∞",
                        description: "–ó–∞–≤–µ—Ä—à–∏—Ç–µ 5 —Ñ–æ–∫—É—Å-—Å–µ—Å—Å–∏–π",
                        icon: "üéØ",
                        xp_reward: 100
                    },
                    {
                        name: "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å", 
                        description: "–ó–∞–ø–∏—à–∏—Ç–µ 10 —ç–º–æ—Ü–∏–π",
                        icon: "üòä",
                        xp_reward: 80
                    }
                ],
                shop_items: [
                    {
                        id: 1,
                        name: "–ë—É—Å—Ç –æ–ø—ã—Ç–∞",
                        description: "+25% –∫ –ø–æ–ª—É—á–∞–µ–º–æ–º—É –æ–ø—ã—Ç—É –Ω–∞ 24 —á–∞—Å–∞", 
                        price: 100,
                        item_type: 'boost'
                    },
                    {
                        id: 2,
                        name: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫",
                        description: "+50 —ç–Ω–µ—Ä–≥–∏–∏",
                        price: 75,
                        item_type: 'boost'
                    }
                ],
                inventory: [
                    {
                        id: 1,
                        name: "–ë—É—Å—Ç –æ–ø—ã—Ç–∞",
                        description: "–ê–∫—Ç–∏–≤–µ–Ω –µ—â–µ 12 —á–∞—Å–æ–≤",
                        quantity: 1
                    }
                ],
                leaderboard: [
                    { username: "–ê–ª–µ–∫—Å–µ–π", current_level: 15, total_xp: 5000, life_coins: 2500 },
                    { username: "–ú–∞—Ä–∏—è", current_level: 12, total_xp: 3500, life_coins: 1800 },
                    { username: "–î–º–∏—Ç—Ä–∏–π", current_level: 8, total_xp: 2000, life_coins: 1200 }
                ],
                total_quests_completed: 12,
                is_real_data: false // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
            };
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function renderUserData() {
            if (!userData) return;

            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            document.getElementById('playerLevel').textContent = 
                `–£—Ä–æ–≤–µ–Ω—å ${userData.level} ‚Ä¢ ${userData.title}`;
            document.getElementById('xpText').textContent = 
                `${userData.xp} / ${userData.next_level_xp} XP`;
            document.getElementById('coinsValue').textContent = 
                `${userData.coins} ü™ô`;
            document.getElementById('energyValue').textContent = 
                `${userData.energy} ‚ö°`;

            // –ü—Ä–æ—Ñ–∏–ª—å
            document.getElementById('profileLevel').textContent = userData.level;
            document.getElementById('completedQuests').textContent = userData.total_quests_completed;
            document.getElementById('totalXP').textContent = userData.xp;
            document.getElementById('lifeGoal').textContent = userData.life_goal;
            document.getElementById('focusArea').textContent = userData.focus_area;

            // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
            const xpBar = document.getElementById('xpBar');
            if (xpBar) {
                xpBar.style.width = '0%';
                setTimeout(() => {
                    xpBar.style.width = userData.xp_progress + '%';
                }, 300);
            }

            // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–≤–µ—Å—Ç–æ–≤
            renderQuests();
            
            // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
            renderAchievements();
            
            // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –º–∞–≥–∞–∑–∏–Ω–∞
            renderShop();
            
            // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            renderInventory();
            
            // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ä–µ–π—Ç–∏–Ω–≥–∞
            renderLeaderboard();
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–≤–µ—Å—Ç–æ–≤
        function renderQuests() {
            const container = document.getElementById('questsList');
            if (!userData.quests || userData.quests.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üéØ</div>
                        <div>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤</div>
                        <div style="font-size: 12px; margin-top: 8px;">–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–≤–µ—Å—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –±–æ—Ç–µ</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = userData.quests.map(quest => {
                const progress = (quest.progress / Math.max(quest.target, 1)) * 100;
                return `
                    <div class="quest-card">
                        <div class="quest-title">${quest.title}</div>
                        <div style="font-size: 12px; color: #666; margin-bottom: 8px;">${quest.description}</div>
                        <div class="quest-progress">
                            <div class="quest-progress-bar" style="width: ${progress}%"></div>
                        </div>
                        <div style="font-size: 11px; color: #888; margin-bottom: 8px;">
                            ${quest.progress}/${quest.target} ‚Ä¢ 
                            –ù–∞–≥—Ä–∞–¥–∞: ${quest.xp_reward} XP + ${quest.coins_reward} ü™ô
                        </div>
                        <button onclick="completeQuest('${quest.id}')" 
                                style="background: var(--success); color: white; border: none; padding: 8px 12px; border-radius: 6px; width: 100%; cursor: pointer; font-size: 12px;">
                            ‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å –∫–≤–µ—Å—Ç
                        </button>
                    </div>
                `;
            }).join('');
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        function renderAchievements() {
            const container = document.getElementById('achievementsList');
            if (!userData.achievements || userData.achievements.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-icon">üèÜ</div>
                        <div>–î–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</div>
                        <div style="font-size: 12px; margin-top: 8px;">–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = userData.achievements.map(achievement => `
                <div class="achievement-card">
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div class="achievement-name">${achievement.name}</div>
                    <div class="achievement-desc">${achievement.description}</div>
                    <div style="font-size: 10px; color: var(--success); margin-top: 5px;">
                        +${achievement.xp_reward} XP
                    </div>
                </div>
            `).join('');
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –º–∞–≥–∞–∑–∏–Ω–∞
        function renderShop() {
            const container = document.getElementById('shopItems');
            if (!userData.shop_items || userData.shop_items.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üè™</div>
                        <div>–ú–∞–≥–∞–∑–∏–Ω –ø—É—Å—Ç</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = userData.shop_items.map(item => `
                <div class="shop-item">
                    <div class="item-info">
                        <div class="item-name">${item.name}</div>
                        <div style="font-size: 12px; color: #666;">${item.description}</div>
                        <div class="item-price">${item.price} ü™ô</div>
                    </div>
                    <button class="buy-button" onclick="buyItem('${item.id}')">
                        –ö—É–ø–∏—Ç—å
                    </button>
                </div>
            `).join('');
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function renderInventory() {
            const container = document.getElementById('inventoryList');
            if (!userData.inventory || userData.inventory.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üì¶</div>
                        <div>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>
                        <div style="font-size: 12px; margin-top: 8px;">–ü–æ—Å–µ—Ç–∏—Ç–µ –º–∞–≥–∞–∑–∏–Ω —á—Ç–æ–±—ã –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç—ã</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = userData.inventory.map(item => `
                <div class="shop-item">
                    <div class="item-info">
                        <div class="item-name">${item.name} √ó${item.quantity}</div>
                        <div style="font-size: 12px; color: #666;">${item.description}</div>
                    </div>
                    <button class="buy-button" onclick="useItem('${item.id}')" 
                            style="background: var(--accent);">
                        –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
                    </button>
                </div>
            `).join('');
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ä–µ–π—Ç–∏–Ω–≥–∞
        function renderLeaderboard() {
            const container = document.getElementById('leaderboardList');
            if (!userData.leaderboard || userData.leaderboard.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üèÖ</div>
                        <div>–†–µ–π—Ç–∏–Ω–≥ –ø—É—Å—Ç</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = userData.leaderboard.map((player, index) => {
                const medal = index === 0 ? "ü•á" : index === 1 ? "ü•à" : index === 2 ? "ü•â" : `${index + 1}.`;
                const username = player.username || player.first_name || `–ò–≥—Ä–æ–∫ ${index + 1}`;
                return `
                    <div class="quest-card">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>${medal} ${username}</strong>
                                <div style="font-size: 12px; color: #666;">
                                    –£—Ä. ${player.current_level} ‚Ä¢ ${player.total_xp} XP
                                </div>
                            </div>
                            <div style="font-weight: bold; color: var(--primary);">
                                ${player.life_coins} ü™ô
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            const backButton = document.querySelector('.back-button');
            if (sectionId === 'main') {
                backButton.style.display = 'none';
            } else {
                backButton.style.display = 'flex';
            }
            
            updateHeader(sectionId);
        }
        
        function updateHeader(sectionId) {
            const titles = {
                'main': 'üéÆ LifeQuest',
                'quests': 'üéØ –ö–≤–µ—Å—Ç—ã',
                'achievements': 'üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è', 
                'shop': 'üè™ –ú–∞–≥–∞–∑–∏–Ω',
                'inventory': 'üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å',
                'profile': 'üë§ –ü—Ä–æ—Ñ–∏–ª—å',
                'leaderboard': 'üèÖ –†–µ–π—Ç–∏–Ω–≥'
            };
            
            const titleElement = document.querySelector('.app-title');
            if (titleElement && titles[sectionId]) {
                titleElement.textContent = titles[sectionId];
            }
        }
        
        // –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–æ—Ç–æ–º
        function sendDataToBot(action, data) {
            if (tg && tg.sendData) {
                tg.sendData(JSON.stringify({
                    action: action,
                    ...data,
                    user_id: userData.user_id
                }));
            } else {
                console.log('Bot action:', action, data);
                alert('–î–µ–π—Å—Ç–≤–∏–µ: ' + action + '\n–î–∞–Ω–Ω—ã–µ: ' + JSON.stringify(data) + 
                      '\n\n–í —Ä–µ–∞–ª—å–Ω–æ–º Mini-App —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ—Ç—É');
            }
        }
        
        function buyItem(itemId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∫—É–ø–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç?')) {
                sendDataToBot('buy_item', { item_id: itemId });
            }
        }
        
        function completeQuest(questId) {
            sendDataToBot('complete_quest', { quest_id: questId });
        }
        
        function useItem(itemId) {
            sendDataToBot('use_item', { item_id: itemId });
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.showSection = showSection;
        window.buyItem = buyItem;
        window.completeQuest = completeQuest;
        window.useItem = useItem;

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π Telegram
        if (tg) {
            tg.onEvent('viewportChanged', function() {
                tg.expand();
            });
            
            tg.onEvent('closeButtonClicked', function() {
                tg.close();
            });
        }
    </script>
</body>
</html>
